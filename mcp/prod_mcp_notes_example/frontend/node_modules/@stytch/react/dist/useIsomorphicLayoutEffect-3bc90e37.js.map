{"version":3,"file":"useIsomorphicLayoutEffect-3bc90e37.js","sources":["../../js-utils/src/createDeepEqual.ts","../../js-utils/src/mergeWithStableProps.ts","../../../internal/react-shared/src/utils/async.ts","../../../internal/react-shared/src/utils/invariant.ts","../../../internal/react-shared/src/utils/useIsomorphicLayoutEffect.ts"],"sourcesContent":["type DeepEqualOpts = {\n  KEYS_TO_EXCLUDE?: string[];\n};\n\nexport const createDeepEqual = ({ KEYS_TO_EXCLUDE = [] }: DeepEqualOpts = {}) => {\n  // If comparing functions, this may need some work. Not sure the\n  // best path for this: compare instance (what it currently does),\n  // stringify and compare, etc.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const deepEqual = (a: any, b: any): boolean => {\n    // Ensures type is the same\n    if (typeof a !== typeof b) return false;\n    // arrays, null, and objects all have type 'object'\n    if (a === null || b === null) return a === b;\n    if (typeof a === 'object') {\n      if (Object.keys(a).length !== Object.keys(b).length || Object.keys(a).some((k) => !(k in b))) return false;\n      return Object.entries(a)\n        .filter(([k]) => !KEYS_TO_EXCLUDE.includes(k))\n        .every(([k, v]) => deepEqual(v, b[k]));\n    }\n    // boolean, string, number, undefined\n    return a === b;\n  };\n\n  return deepEqual;\n};\n","import { createDeepEqual } from './createDeepEqual';\n\nconst deepEqual = createDeepEqual();\n\n/**\n * Returns a version of `newValue` whose properties that are deeply equal to\n * those in `oldValue` are replaced with those from `oldValue`. This provides a\n * limited form of \"structural sharing\" that provides a stable reference for\n * unchanged slices of the object.\n *\n * If `oldValue` and `newValue` are referentially equal, the same value is\n * returned.\n *\n * @param oldValue The old value\n * @param newValue The new value\n */\nexport const mergeWithStableProps = <T extends Record<string, unknown>, U extends Record<string, unknown> = T>(\n  oldValue: U,\n  newValue: T,\n): T => {\n  // If the values are already referentially the same, just return the new value\n  if ((oldValue as unknown) === newValue) {\n    return newValue;\n  }\n\n  return Object.keys(oldValue).reduce(\n    (acc, key) => {\n      if (key in newValue && deepEqual(oldValue[key], newValue[key])) {\n        acc[key as keyof T] = oldValue[key] as unknown as T[keyof T];\n      }\n      return acc;\n    },\n    { ...newValue },\n  );\n};\n","import { Dispatch, SetStateAction, useCallback, useEffect, useRef, useState } from 'react';\n\n// useState can cause memory leaks if it is set after the component unmounted. For example, if it is\n// set after `await`, or in a `then`, `catch`, or `finally`, or in a setTimout/setInterval.\nexport const useAsyncState = <T>(initialState: T | (() => T)): [T, Dispatch<SetStateAction<T>>] => {\n  const isMounted = useRef<boolean>(true);\n  const [state, setState] = useState<T>(initialState);\n\n  useEffect(() => {\n    isMounted.current = true;\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n\n  const setStateAction = useCallback<Dispatch<SetStateAction<T>>>((newState) => {\n    if (isMounted.current) {\n      setState(newState);\n    }\n  }, []);\n\n  return [state, setStateAction];\n};\n","export function invariant(cond: unknown, message: string): asserts cond {\n  if (!cond) throw new Error(message);\n}\n","import { useLayoutEffect, useEffect } from 'react';\n// cc https://medium.com/@alexandereardon/uselayouteffect-and-ssr-192986cdcf7a\nconst useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\nexport default useIsomorphicLayoutEffect;\n"],"names":[],"mappings":"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"}