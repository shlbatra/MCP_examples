import { PromptMomentNotification } from 'google-one-tap';
import { SessionDurationOptions } from '@stytch/core/public';

type OneTapNotShownReason = ReturnType<PromptMomentNotification['getNotDisplayedReason']> | ReturnType<PromptMomentNotification['getSkippedReason']>;
type OneTapRenderResult = {
    success: true;
} | {
    success: false;
    reason: OneTapNotShownReason;
};

type ParseAuthenticateUrl<HandledTokenType extends string> = (href?: string) => {
    handled: true;
    token: string;
    tokenType: HandledTokenType;
} | {
    handled: false;
    token: string;
    tokenType: string;
} | null;
type AuthenticateByUrl<TokenType extends string> = (options: {
    /**
     * Clear token and stytch_token_type URL params after authenticate is called.
     * @default true if the href parameter is window.location.href (the default)
     **/
    clearParams?: boolean;
} & SessionDurationOptions, 
/**
 * Allow overriding URL where the token and stytch_token_type params are extracted from.
 * You usually would not need to set this.
 * @default window.location.href
 */
href?: string) => Promise<{
    handled: true;
    tokenType: TokenType;
    data: unknown;
} | {
    handled: false;
    tokenType: string;
    token: string;
} | null>;

export type { AuthenticateByUrl as A, OneTapRenderResult as O, ParseAuthenticateUrl as P };
