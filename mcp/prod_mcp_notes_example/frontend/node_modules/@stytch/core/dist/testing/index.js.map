{"version":3,"file":"index.js","sources":["../../../../internal/mocks/src/index.ts","../../src/testing/testUtils.ts"],"sourcesContent":["export const MOCK_PUBLIC_TOKEN = 'public-token-test-123';\nexport const MOCK_METHOD_ID = 'method-test-123-xyz';\nexport const MOCK_PHONE_NUMBER = '123457890';\nexport const MOCK_EMAIL = 'example@stytch.com';\nexport const MOCK_PASSWORD = 'correcthorsebatterystaple';\nexport const MOCK_CAPTCHA = 'mock-captcha-token';\nexport const MOCK_DFP_TELEMTRY_ID = 'dfp-telemetry-id-123';\nexport const MOCK_CODE = '123456';\nexport const MOCK_REQUEST_ID = 'request-id-live-123-123-123';\nexport const MOCK_ORG_ID = 'org-1234';\n\nexport const MOCK_USER = {\n  user_id: 'mock_user_id',\n};\nexport const MOCK_SESSION = {\n  session_id: 'mock_session_id',\n};\n\nexport const MOCK_MEMBER = {\n  member_id: 'mock_user_id',\n  member_password_id: 'mock_member_password_id',\n  member_totp_id: 'mock_member_totp_id',\n};\nexport const MOCK_MEMBER_SESSION = {\n  member_session_id: 'mock_session_id',\n};\n\nexport const MOCK_ORGANIZATION = {\n  organization_id: MOCK_ORG_ID,\n};\n\nexport const MOCK_MEMBER_COMMON_RESPONSE = {\n  member_id: MOCK_MEMBER.member_id,\n  member: MOCK_MEMBER,\n  organization: MOCK_ORGANIZATION,\n  status_code: 200,\n};\n\nexport const MOCK_INTERMEDIATE_SESSION_TOKEN = 'mock-intermediate-session-token';\n\nexport const MOCK_DISCOVERED_ORGANIZATION = {\n  organization: MOCK_ORGANIZATION,\n  membership: {\n    type: 'active_member',\n    member: MOCK_MEMBER,\n  },\n  member_authenticated: false,\n  mfa_required: { member_options: { phone_number: MOCK_PHONE_NUMBER }, secondary_auth_initiated: 'sms_otp' },\n  primary_required: { allowed_auth_methods: [] },\n};\n\nexport const MOCK_WEBAUTHN_REGISTRATIONS = [\n  {\n    authenticator_type: '',\n    domain: 'localhost',\n    name: 'Mac OS',\n    user_agent:\n      'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36',\n    verified: true,\n    webauthn_registration_id: 'webauthn-registration-test-db72fcc0-edae-4bb4-8d52-0b2a765683df',\n  },\n  {\n    authenticator_type: '',\n    domain: 'localhost',\n    name: 'WebAuthN 76b8d7d5',\n    user_agent:\n      'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36',\n    verified: true,\n    webauthn_registration_id: 'webauthn-registration-test-e5ebf060-8a36-438b-893b-a20076b8d7d5',\n  },\n];\n\nexport const MOCK_WEBAUTHN_REGISTRATION = MOCK_WEBAUTHN_REGISTRATIONS[0];\n\nexport const MOCK_AUTHENTICATE_PAYLOAD = {\n  session: MOCK_SESSION,\n  __user: MOCK_USER,\n  user: MOCK_USER,\n  session_token: 'session_token',\n  session_jwt: 'session_jwt.xxx.xxx',\n  user_id: MOCK_USER.user_id,\n};\n\nexport const updateSessionExpect = (additionalProperties: Record<string, unknown> = {}) =>\n  expect.objectContaining({\n    session: MOCK_SESSION,\n    // updateSession does not care about this property, but it is returned in authenticate response\n    // __user: MOCK_USER,\n    user: MOCK_USER,\n    session_token: 'session_token',\n    session_jwt: 'session_jwt.xxx.xxx',\n    user_id: MOCK_USER.user_id,\n    ...additionalProperties,\n  });\n\nexport const MOCK_AUTHENTICATE_STATE_UPDATE = {\n  state: {\n    session: MOCK_SESSION,\n    user: MOCK_USER,\n  },\n  session_token: 'session_token',\n  session_jwt: 'session_jwt.xxx.xxx',\n  intermediate_session_token: null,\n};\n\nexport const MOCK_IST_UPDATE = {\n  state: null,\n  session_token: null,\n  session_jwt: null,\n  intermediate_session_token: 'intermediate_session_token',\n};\n\nexport const MOCK_B2B_AUTHENTICATE_RETURN_VALUE = {\n  member_session: MOCK_MEMBER_SESSION,\n  member: MOCK_MEMBER,\n  session_token: 'session_token',\n  session_jwt: 'session_jwt.xxx.xxx',\n  member_id: MOCK_MEMBER.member_id,\n  organization: MOCK_ORGANIZATION,\n};\n\nexport const MOCK_B2B_AUTHENTICATE_PAYLOAD = {\n  member_session: MOCK_MEMBER_SESSION,\n  member: MOCK_MEMBER,\n  session_token: 'session_token',\n  session_jwt: 'session_jwt.xxx.xxx',\n  member_id: MOCK_MEMBER.member_id,\n  organization: MOCK_ORGANIZATION,\n};\n\nexport const MOCK_B2B_AUTHENTICATE_WITH_MFA_REQUIRED_PAYLOAD = {\n  member_session: null,\n  member: MOCK_MEMBER,\n  session_token: '',\n  session_jwt: '',\n  member_id: MOCK_MEMBER.member_id,\n  organization: MOCK_ORGANIZATION,\n  member_authenticated: false,\n  intermediate_session_token: 'mock-intermediate-session-token',\n  mfa_required: { member_options: { phone_number: MOCK_PHONE_NUMBER }, secondary_auth_initiated: 'sms_otp' },\n};\n\nexport const MOCK_B2B_AUTHENTICATE_WITH_MFA_NOT_REQUIRED_PAYLOAD = {\n  member_session: MOCK_MEMBER_SESSION,\n  member: MOCK_MEMBER,\n  session_token: 'session_token',\n  session_jwt: 'session_jwt.xxx.xxx',\n  member_id: MOCK_MEMBER.member_id,\n  organization: MOCK_ORGANIZATION,\n  member_authenticated: true,\n  intermediate_session_token: '',\n  mfa_required: null,\n};\n\nexport const MOCK_B2B_AUTHENTICATE_STATE_UPDATE = {\n  state: {\n    session: MOCK_MEMBER_SESSION,\n    member: MOCK_MEMBER,\n    organization: MOCK_ORGANIZATION,\n  },\n  session_token: 'session_token',\n  session_jwt: 'session_jwt.xxx.xxx',\n  intermediate_session_token: null,\n};\n\nexport const MOCK_B2B_AUTHENTICATE_IST_UPDATE = {\n  state: null,\n  session_token: null,\n  session_jwt: null,\n  intermediate_session_token: 'mock-intermediate-session-token',\n};\n\nexport const MOCK_AUTHENTICATE_RETURN_VALUE = {\n  session: MOCK_SESSION,\n  user: MOCK_USER,\n  session_token: 'session_token',\n  session_jwt: 'session_jwt.xxx.xxx',\n  user_id: MOCK_USER.user_id,\n};\n\nexport const MOCK_B2B_DISCOVERY_AUTHENTICATE_PAYLOAD = {\n  intermediate_session_token: 'intermediate_session_token',\n  email_address: MOCK_EMAIL,\n  discovered_organizations: [MOCK_DISCOVERED_ORGANIZATION],\n};\n\nexport const MOCK_SSO_CONNECTIONS = [\n  {\n    connection_id: 'connection-1',\n    display_name: 'Google Workspace',\n    identity_provider: 'google-workspace',\n  },\n  {\n    connection_id: 'connection-2',\n    display_name: 'Microsoft Entra',\n    identity_provider: 'microsoft-entra',\n  },\n  {\n    connection_id: 'connection-3',\n    display_name: 'Okta',\n    identity_provider: 'okta',\n  },\n];\n\n// jest.setup.js mocks out crypto.getRandomValues to ensure these stay in sync\nexport const MOCK_VERIFIER = '00000000000000000000000000000000';\nexport const MOCK_CHALLENGE = 'hODA6vqpWjTCk_J4rFLkXOU3urXnUqAOaVmhOuEDtlo';\n\nexport const MOCK_KEYPAIR = {\n  code_challenge: MOCK_CHALLENGE,\n  code_verifier: MOCK_VERIFIER,\n};\n\nexport const MOCK_UNRECOVERABLE_ERROR_DATA = {\n  error_message: 'Unrecoverable',\n  error_type: 'unauthorized_credentials',\n  error_url: '',\n  status_code: 403,\n};\n\nexport const MOCK_RECOVERABLE_ERROR_DATA = {\n  error_message: 'Recoverable',\n  error_type: 'Who knows?',\n  error_url: '',\n  status_code: 502,\n};\n\nexport const MOCK_WEBAUTHN_REG_NOT_FOUND_DATA = {\n  error_message: 'The WebAuthn registration could not be found.',\n  error_type: 'webauthn_registration_not_found',\n  error_url: '',\n  status_code: 404,\n};\n\nexport const MOCK_CONNECTED_APP_PUBLIC = {\n  client_id: 'client-123',\n  client_type: 'web',\n  client_name: 'Test Client',\n  client_description: 'Test Client Description',\n};\n","import { MOCK_CAPTCHA, MOCK_DFP_TELEMTRY_ID, MOCK_KEYPAIR } from '@stytch/internal-mocks';\nimport { INetworkClient, RetriableError, SDKBaseRequestInfo } from '../NetworkClient';\nimport { ISyncPKCEManager, ProofkeyPair } from '../PKCEManager';\nimport { IB2BSubscriptionService, IConsumerSubscriptionService } from '../SubscriptionService';\nimport { StytchProjectConfigurationInput } from '../public/typeConfig';\nimport { IStorageClient } from '../StorageClient';\n\ntype DFPProtectedAuthState = {\n  mockTelemetryID?: string;\n  enabled: boolean;\n  executeRecaptcha: () => Promise<string | undefined>;\n};\n\nexport class MockDFPProtectedAuth {\n  private state: DFPProtectedAuthState;\n\n  constructor(\n    enabled: boolean,\n    mockTelemetryID: string | undefined,\n    executeRecaptcha: () => Promise<string | undefined> = () => Promise.resolve(undefined),\n  ) {\n    this.state = {\n      enabled,\n      mockTelemetryID,\n      executeRecaptcha,\n    };\n  }\n\n  isEnabled = async (): Promise<boolean> => {\n    return Promise.resolve(this.state.enabled);\n  };\n\n  getTelemetryID = async (): Promise<string | undefined> => {\n    return Promise.resolve(this.state.mockTelemetryID);\n  };\n\n  getDFPTelemetryIDAndCaptcha = async (): Promise<{ dfp_telemetry_id?: string; captcha_token?: string }> => {\n    const { enabled, executeRecaptcha } = await this.state;\n\n    let dfp_telemetry_id: string | undefined = undefined;\n    let captcha_token: string | undefined = undefined;\n    if (enabled) {\n      dfp_telemetry_id = await this.getTelemetryID();\n    } else {\n      captcha_token = await executeRecaptcha();\n    }\n    return { dfp_telemetry_id, captcha_token };\n  };\n\n  executeRecaptcha = async (): Promise<string | undefined> => {\n    return this.executeRecaptcha();\n  };\n\n  retryWithCaptchaAndDFP = async (e: RetriableError, req: SDKBaseRequestInfo): Promise<SDKBaseRequestInfo> => {\n    if (this.state.enabled) {\n      if (req.body) {\n        req.body.dfp_telemetry_id = this.state.mockTelemetryID;\n        req.body.captcha_token = await this.executeRecaptcha();\n      }\n      return req;\n    }\n    return req;\n  };\n}\n\nexport const MockDFPProtectedAuthDisabled = (): MockDFPProtectedAuth =>\n  new MockDFPProtectedAuth(false, undefined, () => Promise.resolve(undefined));\n\nexport const MockDFPProtectedAuthCaptchaOnly = () =>\n  new MockDFPProtectedAuth(false, undefined, () => Promise.resolve(MOCK_CAPTCHA));\n\nexport const MockDFPProtectedAuthDFPAndCaptcha = () =>\n  new MockDFPProtectedAuth(true, MOCK_DFP_TELEMTRY_ID, () => Promise.resolve(MOCK_CAPTCHA));\n\nexport const MockDFPProtectedAuthDFPOnly = () =>\n  new MockDFPProtectedAuth(true, MOCK_DFP_TELEMTRY_ID, () => Promise.resolve(undefined));\n\nexport class MockPKCEManager implements ISyncPKCEManager {\n  private pair: ProofkeyPair | undefined;\n\n  constructor() {\n    this.pair = undefined;\n  }\n\n  setPKPair(pair: ProofkeyPair) {\n    this.pair = pair;\n  }\n\n  clearPKPair(): void {\n    this.pair = undefined;\n  }\n\n  getPKPair(): ProofkeyPair | undefined {\n    return this.pair;\n  }\n\n  startPKCETransaction(): Promise<ProofkeyPair> {\n    this.pair = MOCK_KEYPAIR;\n    return Promise.resolve(this.pair);\n  }\n}\n\nexport type INetworkClientMock = {\n  [k in keyof INetworkClient]: jest.Mock;\n};\n\nexport type IConsumerSubscriptionServiceMock = {\n  [k in keyof IConsumerSubscriptionService<StytchProjectConfigurationInput>]: jest.Mock;\n};\n\nexport type IB2BSubscriptionServiceMock = {\n  [k in keyof IB2BSubscriptionService<StytchProjectConfigurationInput>]: jest.Mock;\n};\n\nexport const createTestFixtures = (): {\n  networkClient: INetworkClientMock;\n  apiNetworkClient: INetworkClientMock;\n  subscriptionService: IConsumerSubscriptionServiceMock;\n  pkceManager: MockPKCEManager;\n  secondPKCEManager: MockPKCEManager;\n  captchaProvider: () => Promise<string>;\n  dfpProtectedAuth: MockDFPProtectedAuth;\n} => {\n  const networkClient: INetworkClientMock = {\n    fetchSDK: jest.fn(),\n    retriableFetchSDK: jest.fn(),\n    logEvent: jest.fn(),\n    createTelemetryBlob: jest.fn(),\n    updateSessionToken: jest.fn(),\n  };\n\n  const apiNetworkClient: INetworkClientMock = {\n    fetchSDK: jest.fn(),\n    retriableFetchSDK: jest.fn(),\n    logEvent: jest.fn(),\n    createTelemetryBlob: jest.fn(),\n    updateSessionToken: jest.fn(),\n  };\n\n  const updateSession = jest.fn();\n  const subscriptionService: IConsumerSubscriptionServiceMock = {\n    updateStateAndTokens: jest.fn(),\n    updateState: jest.fn(),\n    getState: jest.fn(),\n    updateUser: jest.fn(),\n    destroyState: jest.fn(),\n    updateSession,\n    withUpdateSession: jest.fn().mockImplementation((fn) => async (...args: unknown[]) => {\n      const resp = await fn(...args);\n      updateSession(resp);\n      return resp;\n    }),\n    destroySession: jest.fn(),\n    getSession: jest.fn(),\n    subscribeToState: jest.fn(),\n    getUser: jest.fn(),\n    getTokens: jest.fn(),\n    syncFromDeviceStorage: jest.fn(),\n    updateTokens: jest.fn(),\n    getIntermediateSessionToken: jest.fn(),\n    getFromCache: jest.fn(),\n    setCacheRefreshed: jest.fn(),\n  };\n\n  const pkceManager = new MockPKCEManager();\n  const secondPKCEManager = new MockPKCEManager();\n\n  const captchaProvider = () => Promise.resolve(MOCK_CAPTCHA);\n\n  const dfpProtectedAuth = new MockDFPProtectedAuth(false, undefined, captchaProvider);\n\n  return {\n    networkClient,\n    apiNetworkClient,\n    subscriptionService,\n    pkceManager,\n    secondPKCEManager,\n    captchaProvider,\n    dfpProtectedAuth,\n  };\n};\n\nexport const createB2BTestFixtures = (): {\n  networkClient: INetworkClientMock;\n  apiNetworkClient: INetworkClientMock;\n  subscriptionService: IB2BSubscriptionServiceMock;\n  pkceManager: MockPKCEManager;\n  secondPKCEManager: MockPKCEManager;\n  captchaProvider: () => Promise<string>;\n} => {\n  const networkClient: INetworkClientMock = {\n    fetchSDK: jest.fn(),\n    retriableFetchSDK: jest.fn(),\n    logEvent: jest.fn(),\n    createTelemetryBlob: jest.fn(),\n    updateSessionToken: jest.fn(),\n  };\n\n  const apiNetworkClient: INetworkClientMock = {\n    fetchSDK: jest.fn(),\n    retriableFetchSDK: jest.fn(),\n    logEvent: jest.fn(),\n    createTelemetryBlob: jest.fn(),\n    updateSessionToken: jest.fn(),\n  };\n\n  const updateSession = jest.fn();\n  const subscriptionService: IB2BSubscriptionServiceMock = {\n    updateStateAndTokens: jest.fn(),\n    updateState: jest.fn(),\n    getState: jest.fn(),\n    updateMember: jest.fn(),\n    destroyState: jest.fn(),\n    updateSession,\n    withUpdateSession: jest.fn().mockImplementation((fn) => async (...args: unknown[]) => {\n      const resp = await fn(...args);\n      updateSession(resp);\n      return resp;\n    }),\n    destroySession: jest.fn(),\n    getSession: jest.fn(),\n    subscribeToState: jest.fn(),\n    getMember: jest.fn(),\n    getTokens: jest.fn(),\n    syncFromDeviceStorage: jest.fn(),\n    updateTokens: jest.fn(),\n    getIntermediateSessionToken: jest.fn(),\n    getOrganization: jest.fn(),\n    updateOrganization: jest.fn(),\n    getFromCache: jest.fn(),\n    setCacheRefreshed: jest.fn(),\n  };\n\n  const pkceManager = new MockPKCEManager();\n  const secondPKCEManager = new MockPKCEManager();\n\n  const captchaProvider = () => Promise.resolve(MOCK_CAPTCHA);\n\n  return {\n    networkClient,\n    apiNetworkClient,\n    subscriptionService,\n    pkceManager,\n    secondPKCEManager,\n    captchaProvider,\n  };\n};\n\nexport const createResolvablePromise = <T = void>() => {\n  let resolve: ((value: T) => void) | undefined;\n  let reject: ((error?: unknown) => void) | undefined;\n  const promise = new Promise<T>((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return { promise, resolve: resolve as NonNullable<typeof resolve>, reject: reject as NonNullable<typeof reject> };\n};\n\nexport function getMockStorageClient() {\n  return {\n    getData: jest.fn(),\n    setData: jest.fn(),\n    clearData: jest.fn(),\n  } satisfies IStorageClient;\n}\n\nexport const PUBLIC_TOKEN = 'public-token-test-1234';\n"],"names":["MOCK_CAPTCHA","MOCK_DFP_TELEMTRY_ID","MOCK_VERIFIER","MOCK_CHALLENGE","MOCK_KEYPAIR","code_challenge","code_verifier","MockDFPProtectedAuth","_createClass","enabled","mockTelemetryID","_this","executeRecaptcha","arguments","length","undefined","Promise","resolve","_classCallCheck","isEnabled","__awaiter","_regenerator","m","_callee","w","_context","n","a","state","getTelemetryID","_callee2","_context2","getDFPTelemetryIDAndCaptcha","_callee3","_yield$this$state","dfp_telemetry_id","captcha_token","_context3","v","_callee4","_context4","retryWithCaptchaAndDFP","e","req","_callee5","_context5","body","MockDFPProtectedAuthDisabled","MockDFPProtectedAuthCaptchaOnly","MockDFPProtectedAuthDFPAndCaptcha","MockDFPProtectedAuthDFPOnly","MockPKCEManager","pair","key","value","setPKPair","clearPKPair","getPKPair","startPKCETransaction","createTestFixtures","networkClient","fetchSDK","jest","fn","retriableFetchSDK","logEvent","createTelemetryBlob","updateSessionToken","apiNetworkClient","updateSession","subscriptionService","updateStateAndTokens","updateState","getState","updateUser","destroyState","withUpdateSession","mockImplementation","_len","args","Array","_key","_callee6","resp","_context6","apply","destroySession","getSession","subscribeToState","getUser","getTokens","syncFromDeviceStorage","updateTokens","getIntermediateSessionToken","getFromCache","setCacheRefreshed","pkceManager","secondPKCEManager","captchaProvider","dfpProtectedAuth","createB2BTestFixtures","updateMember","_len2","_key2","_callee7","_context7","getMember","getOrganization","updateOrganization","createResolvablePromise","reject","promise","res","rej","getMockStorageClient","getData","setData","clearData","PUBLIC_TOKEN"],"mappings":"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"}